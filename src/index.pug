- let uploadsDir = './static/uploads'
doctype html
html(lang="en")
    head
        meta(charset="utf-8")
        title=site.title
        meta(name="description", content=site.description)
        meta(property="og:title" content=site.title)
        meta(property="og:description" content=site.description)
        meta(property="og:url" content=site.url)
        meta(property="og:image" content=uploadsDir+site.preview_image)
        meta(name="twitter:card" content="summary_large_image")
        meta(name="viewport", content="width=device-width")
        //- meta(name="theme-color" content="")
        link(rel="stylesheet", href="./style/main.pcss")
        link(rel="shortcut icon" href=uploadsDir+site.favicon type="image/x-icon")
        //- link(rel="preload" href="" as="")
        script(defer src="./script/main.js")
        script(defer src="https://identity.netlify.com/v1/netlify-identity-widget.js")

    body(class="text-base" style="min-width: 375px;")
        div(class="mx-auto" id="wrapper" style="max-width: 1920px")

            //- Header
            header(id="header-main" class="bg-cover bg-vectors-teal lg:bg-header-main lg:bg-imgcover lg:border-b-8 border-teal")
                //- Mobile cover image
                div(class="aspect ratio-1-2 bg-header-main p-6 bg-imgcover lg:hidden")
                    img(src=uploadsDir+site.main_logo alt="EIT RawMaterials Academy" class="w-1/2 mt-6")
                //- Main Hero
                div(class='max-w-6xl mx-auto p-6 lg:p-4 pb-16 lg:pb-16 lg:flex lg:justify-between')
                    img(src=uploadsDir+site.main_logo alt="EIT RawMaterials Academy" class="hidden lg:block max-w-lg self-start")
                    div(class="lg:w-2/3 self-end mt-16 lg:mt-32 lg:pt-32 lg:pr-12")
                        div(id="cta")
                            h1(class="text-white text-5xl leading-16 mb-1 font-bold")= header.headline
                            div(class="text-white text-4xl leading-16 mb-8")= header.subtitle
                            for btn in header.cta
                                a(class="button button-white icon-arrow-right lg:button-teal mr-6 mb-4" href=btn.href target=btn.target_blank ? '_blank' : '')= btn.title

            //- main section
            main(class="")

                //- About Lightweight Professional Course
                section(id="about" class="px-4 py-24")
                    div(class="max-w-6xl mx-auto")
                        h2(class="mb-2 text-2xl leading-10 lg:text-3xl lg:leading-12 text-blue overline overline-blue")= about.title
                        p(class="mb-6 text-teal text-lg leading-8 lg:text-xl lg:leading-11")= about.intro
                        p(class="")= about.body
                            
                //- Questions
                section(id="questions")
                    each question, i in about.questions
                        div(class="lg:grid grid-cols-2")
                            - let colStart = i&1 ? 2 : 1
                            div(style="min-height: 20rem; background-image: url("+uploadsDir+question.image+")" class="bg-cover bg-top col-span-1 row-span-1 row-start-1 col-start-"+colStart)
                            - colStart = i&1 ? 1 : 2
                            div(class="text-white bg-teal bg-vectors-teal bg-imgcover col-span-1 row-span-1 px-6 py-24 lg:px-24 xl:p-32 row-start-1 col-start-"+colStart)
                                h3(class="font-bold text-3xl leading-12 overline overline-white mb-8")= question.q
                                p= question.a

                section(id="course" class="px-4 py-24 bg-vectors-white-teal bg-right-top bg-no-repeat")
                    //- Lightweight Professional at a glance
                    div(id="at-a-glance" class="max-w-6xl mx-auto")
                        h2(class="text-3xl leading-12 text-blue overline overline-blue mb-12")= about.at_a_glance.title
                        div(class="grid sm:grid-cols-2 lg:grid-cols-4 gap-4 corner-base mb-4")
                            each item in about.at_a_glance.properties
                                div.bg-vectors-teal-light.bg-cover
                                    div
                                        img(src=uploadsDir+item.image alt="" class="mx-auto")
                                    div(class="text-center font-bold text-blue uppercase text-lg px-4 leading-8 mb-10") !{item.title}
                        div.text-sm !{about.at_a_glance.footnote}

                    //- Course overview
                    div(id="overview" class="mt-12 pt-24 pb-16 max-w-6xl mx-auto")
                        h2(class="text-3xl leading-12 text-blue overline overline-blue mb-2")= about.overview.title
                        p(class="intro text-xl leading-11 mb-12")= about.overview.intro
                        ul.overview-table
                            each prop in about.overview.properties
                                li(class="lg:grid grid-cols-3 border-top-blue py-6")
                                    div(class="font-bold col-span-1 col-start-1")= prop.term
                                    if prop.deed
                                        div(class="col-span-2 col-start-2")= prop.deed
                                    if prop.list
                                        div(class="col-span-3 col-start-1 row-start-2")
                                            ul(class="mt-4 mb-3 lg:grid grid-cols-3 gap-4")
                                                each item in prop.list
                                                    li(class="bg-teal-gradient-2 corner-base py-10 px-12 mb-4")
                                                        if item.title
                                                            div(class="text-blue uppercase font-bold text-lg leading-8")= item.title
                                                        if item.intro
                                                            div(class="text-teal text-lg leading-8")= item.intro
                                                        if item.items
                                                            ul.ml-5.mt-4.text-sm.checklist
                                                                each subitem in item.items
                                                                    li(class="icon-check")= subitem

                //- Discover our flexible modules
                section(id="modules" class="bg-white")
                    div(class="bg-teal text-white bg-vectors-teal-wide bg-cover bg-bottom")
                        div(id="modules-intro" class="max-w-6xl mx-auto px-4 pt-24 pb-32")
                            h2(class="text-3xl leading-12 overline overline-white mt-4 mb-2")= about.discover_modules.title
                            p(class="text-white text-xl leading-11")= about.discover_modules.intro
                    //- Levels
                    for level, i in collections.levels
                        - let justOneModule = level.modules.length === 1
                        if level.modules && level.modules.length > 0
                            div(class="pt-24 pb-32 bg-teal-gradient-"+(i+1))
                                - let flexOrNot = justOneModule ? ' lg:flex' : ''
                                div(class="max-w-6xl mx-auto px-4 py-4"+flexOrNot)
                                    //- Level
                                    - let gridCols = level.modules.length <= 2 ? 2 : 4
                                    - let gridDivider = level.modules.length <= 2 ? 1 : 2
                                    div(class=justOneModule ? "lg:w-1/2" : '')
                                        h2(class="text-3xl text-blue leading-12 mb-4") <span class="header-number text-base">#{i+1}</span> #{level.title} Level
                                        p(class="text-teal text-xl leading-11 mb-8 pr-8")= level.summary
                                    - let ulClasses = justOneModule ? 'lg:w-1/2' : "grid gap-4 grid-cols-1 md:grid-cols-"+(gridCols/gridDivider) + " lg:grid-cols-"+gridCols
                                    ul(class="corner-base "+ulClasses)
                                        for mod, j in level.modules
                                            //- Module
                                            - let colStart = justOneModule ? ' col-start-2' : ''
                                            li(class="bg-white"+colStart x-data="{ open: false }")
                                                div(class="bg-vectors-teal-square bg-imgcover text-center")
                                                    img(class="mx-auto" src=uploadsDir+mod.icon alt=mod.title)
                                                div(class="px-6 py-8")
                                                    div(class="text-blue font-bold mb-5 leading-6")= mod.title
                                                    div.text-sm.leading-6.mb-4= mod.summary
                                                    div.font-bold.uppercase.-ml-2.cursor-pointer: a(class="icon-arrow-right modal-opener" @click="open = true") Details
                                                    //- ---------------------------------------------------------------------------------------------------------------------------------------------------
                                                    //- Modal Overlay â€“ PAGE IN PAGE
                                                    //- ---------------------------------------------------------------------------------------------------------------------------------------------------
                                                    div(id="overlay-module-"+j class="z-10 fixed min-w-3xl inset-0 p-4 bg-grey" x-show="open" @click.away="open = false" style="display:none")
                                                        div(class="bg-white shadow-2xl w-full h-full overflow-scroll")
                                                            //- Close Button
                                                            button(@click="open = false" class="modal-closer fixed right-0 top-0 mr-12 mt-12 icon-cancel text-teal text-3xl bg-white hover:text-blue")
                                                            div(class="max-w-2xl mx-auto px-4 py-24")
                                                                //- Module Title/Intro/Summary/Register Button
                                                                h3(class="font-bold text-3xl text-blue mt-12") #{mod.title} (#{level.title} Level)
                                                                div.text-teal.text-xl.leading-11.mb-8= mod.summary
                                                                div.markdown.course-summary
                                                                    != marked(mod.desc, {gfm: true, breaks: true})
                                                                if mod.registerUrl
                                                                    div.text-center
                                                                        a(href=mod.registerUrl target="_blank" class="mt-12 button bg-teal text-white hover:bg-blue hover:text-white") Register now
                                                                //- Course Content
                                                                h4(class="mb-4 mt-24 font-bold text-3xl text-blue overline overline-blue")= about.modules_section.course_content
                                                                div.markdown.course-content
                                                                    != marked(mod.contents, {gfm: true, breaks: true})
                                                            //- Recommended Knowledge
                                                            div(class="bg-teal-gradient-2")
                                                                div(class="max-w-2xl mx-auto px-4 py-24")
                                                                    h3(class="my-4 font-bold text-3xl text-blue mt-12 overline overline-blue")= about.modules_section.recommended_knowledge
                                                                    div.text-teal.text-xl.leading-11.mb-8= mod.recommendedKnowledge ? mod.recommendedKnowledge : about.modules_section.no_prior_knowledge
                                                            //- Dates & Registration
                                                            if about.modules_section.dates
                                                                div(class="bg-vectors-teal text-white px-4 py-24 bg-imgcover")
                                                                    div(class="max-w-2xl mx-auto px-4")
                                                                        h3(class="font-bold text-3xl my-4 overline overline-white")= about.modules_section.dates
                                                                        div.markdown 
                                                                            != marked(mod.dates, {gfm: true, breaks: true})
                                                                        if mod.registerUrl
                                                                            div
                                                                                a(href=mod.registerUrl target="_blank" class="button button-white mt-12") Register now
                                                                        else
                                                                            div.markdown
                                                                                != marked(about.modules_section.no_registration, {gfm: true, breaks: true})
                                                            - let moduleContacts = filter(collections.contacts, {name: mod.contacts})
                                                            - if (moduleContacts.length == 0) {moduleContacts = filter(collections.contacts, {name: 'Beate Brede'})}
                                                            - let moduleContact = moduleContacts.length == 1 ? moduleContacts[0] : false
                                                            //- Contact
                                                            div.bg-vectors.bg-bottom
                                                                div(class="max-w-2xl mx-auto px-4 py-24")
                                                                    h3(class="text-3xl leading-12 text-blue overline overline-blue my-4 mb-2")= contact.title
                                                                    p(class="text-teal text-xl leading-11 mb-12")= contact.intro
                                                                    div.corner-lg.bg-teal-lighter.p-12
                                                                        div.font-bold.text-blue= contact.person.name
                                                                        if contact.person.role
                                                                            div.text-teal= contact.person.role
                                                                        if contact.person.address
                                                                            div.mb-4!= marked(contact.person.address, {gfm: true, breaks: true})
                                                                        if contact.person.phone
                                                                            div= contact.person.phone
                                                                        if contact.person.email
                                                                            div: a(href='mailto:'+contact.person.email target="_blank" class="")= contact.person.email
                                                                        if contact.person.contactUrl
                                                                            div: a(href=contact.person.contactUrl target="_blank" class="")= contact.send_email

                //- Contact
                section(id="contact" class="px-4 py-32 bg-vectors bg-bottom")
                    div(class="max-w-6xl mx-auto")
                        h2(class="text-3xl leading-12 mt-4 mb-2 text-blue overline overline-blue")= contact.title
                        p(class="text-teal text-xl leading-11 mb-12")= contact.intro
                        div(class="bg-teal-lighter px-12 py-12 corner-lg")
                            div(class="text-blue font-bold")= contact.person.name
                            if contact.person.title
                                div(class="text-teal")= contact.person.title
                            if contact.person.address
                                div(class="")
                                    != marked(contact.person.address, {gfm: true, breaks: true})
                            if contact.person.phone
                                div(class="mt-8")= contact.person.phone
                            if contact.person.email
                                div: a(href='mailto:'+contact.person.email)= contact.person.email

                //- Partners
                section(id="partners" class="bg-teal-gradient-1 px-4 py-32")
                    div(class="max-w-6xl mx-auto")
                        h2(class="text-3xl leading-12 text-blue overline overline-blue mb-8")= partners.title
                        ul(class="grid grid-cols-2 lg:grid-cols-4 gap-x-4 gap-y-5 corner-base lg:corner-lg")
                            for partner in partners.items
                                li: img(src=uploadsDir+partner.logo alt=partner.name)
                        

            //- Footer
            footer.bg-blue.text-white.px-4.pt-12.pb-8
                div.max-w-6xl.mx-auto
                    div(class="sm:flex")
                        //- Contact
                        div(class="sm:w-1/2 md:w-1/3 lg:w-1/4")
                            h4.uppercase.mb-4= contact.contact_us
                            div #{site.provider}
                            div
                                - let href = `mailto:${site.email}`
                                a(href=href class="text-white hover:text-teal umami--click--footer-email") #{site.email}
                        //- Social Media
                        div(class="sm:w-1/2 md:w-1/3 lg:w-1/4 mt-8 sm:mt-0")
                            h4.mb-4.uppercase= contact.connect_with_us
                            ul.list-none
                                each link in site.social_links
                                    li.inline.text-2xl.-ml-1.mr-3
                                        - let icon = `<span class="icon-${link.title.toLowerCase()}"></span>`
                                        - let eventClass = 'umami--click--' + link.title.toLowerCase()
                                        a(href=link.href target="_blank" rel="noopener" aria-label=link.title class=eventClass + " text-white hover:text-teal") !{icon}
                    div(class='lg:flex flex-row-reverse justify-between items-end')
                        //- Logo
                        div(class="lg:w-1/4 py-8 sm:pt-8 sm:pb-12 lg:py-0")
                            a(href="https://eitrawmaterials.eu/eit-rm-academy/" target="_blank" rel="noopener")
                                img(src=uploadsDir+site.main_logo alt="EIT RawMaterials Academy")
                        //- Service Links
                        div#service-links
                            ul.font-bold.uppercase
                                for link in site.footer_links
                                    li.inline-block
                                        a(href=link.href target=link.target_blank ? '_blank' : '' rel="noopener" class="text-white hover:text-teal icon-arrow-right mr-8") #{link.title}
